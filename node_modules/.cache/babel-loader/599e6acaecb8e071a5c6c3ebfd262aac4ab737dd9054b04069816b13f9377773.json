{"ast":null,"code":"import { NormalizedSchema, SCHEMA } from \"@smithy/core/schema\";\nimport { LazyJsonString, NumericValue, parseEpochTimestamp, parseRfc3339DateTimeWithOffset, parseRfc7231DateTime, splitHeader } from \"@smithy/core/serde\";\nimport { fromBase64 } from \"@smithy/util-base64\";\nimport { toUtf8 } from \"@smithy/util-utf8\";\nimport { determineTimestampFormat } from \"./determineTimestampFormat\";\nexport class FromStringShapeDeserializer {\n  constructor(settings) {\n    this.settings = settings;\n  }\n  setSerdeContext(serdeContext) {\n    this.serdeContext = serdeContext;\n  }\n  read(_schema, data) {\n    const ns = NormalizedSchema.of(_schema);\n    if (ns.isListSchema()) {\n      return splitHeader(data).map(item => this.read(ns.getValueSchema(), item));\n    }\n    if (ns.isBlobSchema()) {\n      var _this$serdeContext$ba, _this$serdeContext;\n      return ((_this$serdeContext$ba = (_this$serdeContext = this.serdeContext) === null || _this$serdeContext === void 0 ? void 0 : _this$serdeContext.base64Decoder) !== null && _this$serdeContext$ba !== void 0 ? _this$serdeContext$ba : fromBase64)(data);\n    }\n    if (ns.isTimestampSchema()) {\n      const format = determineTimestampFormat(ns, this.settings);\n      switch (format) {\n        case SCHEMA.TIMESTAMP_DATE_TIME:\n          return parseRfc3339DateTimeWithOffset(data);\n        case SCHEMA.TIMESTAMP_HTTP_DATE:\n          return parseRfc7231DateTime(data);\n        case SCHEMA.TIMESTAMP_EPOCH_SECONDS:\n          return parseEpochTimestamp(data);\n        default:\n          console.warn(\"Missing timestamp format, parsing value with Date constructor:\", data);\n          return new Date(data);\n      }\n    }\n    if (ns.isStringSchema()) {\n      const mediaType = ns.getMergedTraits().mediaType;\n      let intermediateValue = data;\n      if (mediaType) {\n        if (ns.getMergedTraits().httpHeader) {\n          intermediateValue = this.base64ToUtf8(intermediateValue);\n        }\n        const isJson = mediaType === \"application/json\" || mediaType.endsWith(\"+json\");\n        if (isJson) {\n          intermediateValue = LazyJsonString.from(intermediateValue);\n        }\n        return intermediateValue;\n      }\n    }\n    switch (true) {\n      case ns.isNumericSchema():\n        return Number(data);\n      case ns.isBigIntegerSchema():\n        return BigInt(data);\n      case ns.isBigDecimalSchema():\n        return new NumericValue(data, \"bigDecimal\");\n      case ns.isBooleanSchema():\n        return String(data).toLowerCase() === \"true\";\n    }\n    return data;\n  }\n  base64ToUtf8(base64String) {\n    var _this$serdeContext$ut, _this$serdeContext2, _this$serdeContext$ba2, _this$serdeContext3;\n    return ((_this$serdeContext$ut = (_this$serdeContext2 = this.serdeContext) === null || _this$serdeContext2 === void 0 ? void 0 : _this$serdeContext2.utf8Encoder) !== null && _this$serdeContext$ut !== void 0 ? _this$serdeContext$ut : toUtf8)(((_this$serdeContext$ba2 = (_this$serdeContext3 = this.serdeContext) === null || _this$serdeContext3 === void 0 ? void 0 : _this$serdeContext3.base64Decoder) !== null && _this$serdeContext$ba2 !== void 0 ? _this$serdeContext$ba2 : fromBase64)(base64String));\n  }\n}","map":{"version":3,"names":["NormalizedSchema","SCHEMA","LazyJsonString","NumericValue","parseEpochTimestamp","parseRfc3339DateTimeWithOffset","parseRfc7231DateTime","splitHeader","fromBase64","toUtf8","determineTimestampFormat","FromStringShapeDeserializer","constructor","settings","setSerdeContext","serdeContext","read","_schema","data","ns","of","isListSchema","map","item","getValueSchema","isBlobSchema","_this$serdeContext$ba","_this$serdeContext","base64Decoder","isTimestampSchema","format","TIMESTAMP_DATE_TIME","TIMESTAMP_HTTP_DATE","TIMESTAMP_EPOCH_SECONDS","console","warn","Date","isStringSchema","mediaType","getMergedTraits","intermediateValue","httpHeader","base64ToUtf8","isJson","endsWith","from","isNumericSchema","Number","isBigIntegerSchema","BigInt","isBigDecimalSchema","isBooleanSchema","String","toLowerCase","base64String","_this$serdeContext$ut","_this$serdeContext2","_this$serdeContext$ba2","_this$serdeContext3","utf8Encoder"],"sources":["/Users/codinggents/Documents/lambdaforge/node_modules/@smithy/core/dist-es/submodules/protocols/serde/FromStringShapeDeserializer.js"],"sourcesContent":["import { NormalizedSchema, SCHEMA } from \"@smithy/core/schema\";\nimport { LazyJsonString, NumericValue, parseEpochTimestamp, parseRfc3339DateTimeWithOffset, parseRfc7231DateTime, splitHeader, } from \"@smithy/core/serde\";\nimport { fromBase64 } from \"@smithy/util-base64\";\nimport { toUtf8 } from \"@smithy/util-utf8\";\nimport { determineTimestampFormat } from \"./determineTimestampFormat\";\nexport class FromStringShapeDeserializer {\n    constructor(settings) {\n        this.settings = settings;\n    }\n    setSerdeContext(serdeContext) {\n        this.serdeContext = serdeContext;\n    }\n    read(_schema, data) {\n        const ns = NormalizedSchema.of(_schema);\n        if (ns.isListSchema()) {\n            return splitHeader(data).map((item) => this.read(ns.getValueSchema(), item));\n        }\n        if (ns.isBlobSchema()) {\n            return (this.serdeContext?.base64Decoder ?? fromBase64)(data);\n        }\n        if (ns.isTimestampSchema()) {\n            const format = determineTimestampFormat(ns, this.settings);\n            switch (format) {\n                case SCHEMA.TIMESTAMP_DATE_TIME:\n                    return parseRfc3339DateTimeWithOffset(data);\n                case SCHEMA.TIMESTAMP_HTTP_DATE:\n                    return parseRfc7231DateTime(data);\n                case SCHEMA.TIMESTAMP_EPOCH_SECONDS:\n                    return parseEpochTimestamp(data);\n                default:\n                    console.warn(\"Missing timestamp format, parsing value with Date constructor:\", data);\n                    return new Date(data);\n            }\n        }\n        if (ns.isStringSchema()) {\n            const mediaType = ns.getMergedTraits().mediaType;\n            let intermediateValue = data;\n            if (mediaType) {\n                if (ns.getMergedTraits().httpHeader) {\n                    intermediateValue = this.base64ToUtf8(intermediateValue);\n                }\n                const isJson = mediaType === \"application/json\" || mediaType.endsWith(\"+json\");\n                if (isJson) {\n                    intermediateValue = LazyJsonString.from(intermediateValue);\n                }\n                return intermediateValue;\n            }\n        }\n        switch (true) {\n            case ns.isNumericSchema():\n                return Number(data);\n            case ns.isBigIntegerSchema():\n                return BigInt(data);\n            case ns.isBigDecimalSchema():\n                return new NumericValue(data, \"bigDecimal\");\n            case ns.isBooleanSchema():\n                return String(data).toLowerCase() === \"true\";\n        }\n        return data;\n    }\n    base64ToUtf8(base64String) {\n        return (this.serdeContext?.utf8Encoder ?? toUtf8)((this.serdeContext?.base64Decoder ?? fromBase64)(base64String));\n    }\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}